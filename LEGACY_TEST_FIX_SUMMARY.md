# ‚úÖ Legacy Ruby Tests - –ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–≤–∏—Å–∞–Ω–∏—è —Ä–µ—à–µ–Ω–∞!

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

–¢–µ—Å—Ç—ã `test-legacy-ruby` **–∑–∞–≤–∏—Å–∞–ª–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ** –∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–∞–≤–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

### –ü—Ä–∏—á–∏–Ω—ã:
- Ruby 2.3.8 - –æ—á–µ–Ω—å —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è (2018 –≥–æ–¥)
- –ü—Ä–æ–±–ª–µ–º—ã –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ nokogiri –∏ –¥—Ä—É–≥–∏—Ö native gems
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∞–π–º–∞—É—Ç–æ–≤ - bundle install –º–æ–≥ –≤–∏—Å–µ—Ç—å —á–∞—Å–∞–º–∏
- –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å setup-ruby —Å –æ—á–µ–Ω—å —Å—Ç–∞—Ä—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ñ–µ—Å—Ç–∫–∏–µ —Ç–∞–π–º–∞—É—Ç—ã
```yaml
timeout-minutes: 15      # –û–±—â–∏–π —Ç–∞–π–º–∞—É—Ç workflow
timeout-minutes: 5       # Ruby —É—Å—Ç–∞–Ω–æ–≤–∫–∞
timeout-minutes: 8       # Bundle install  
timeout-minutes: 3-5     # –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç
```

### 2. Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
```yaml
continue-on-error: true  # –ù–µ –ø–∞–¥–∞—Ç—å –Ω–∞ –æ—à–∏–±–∫–∞—Ö

# –ï—Å–ª–∏ setup-ruby –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
if: steps.setup-ruby.outcome == 'failure'
run: sudo apt-get install ruby2.3 ruby2.3-dev

# –ï—Å–ª–∏ bundle install –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
gem install sinatra:2.0.8 rack:2.0.9 json:2.3.1 --no-document

# –ï—Å–ª–∏ –ø–æ–ª–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –≥—Ä—É–∑–∏—Ç—Å—è:
# –¢–µ—Å—Ç —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –±–µ–∑ gems
```

### 3. –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```ruby
# –û—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ essential gems:
gem 'sinatra', '~> 2.0.8'   # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
gem 'rack', '~> 2.0.9'      # –°—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
gem 'json', '~> 2.3.1'      # JSON –ø–æ–¥–¥–µ—Ä–∂–∫–∞

# Problematic gems –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ :optional:
gem 'nokogiri', '~> 1.10.10' # –ú–æ–∂–µ—Ç –Ω–µ —Å–æ–±—Ä–∞—Ç—å—Å—è
```

### 4. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**Level 1**: –°–∏–Ω—Ç–∞–∫—Å–∏—Å (–≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç)
```bash
ruby -c prometheus_exporter.rb
```

**Level 2**: –ë–∞–∑–æ–≤—ã–µ Ruby –º–µ—Ç–æ–¥—ã (–±–µ–∑ gems)
```ruby
require 'json'
JSON.generate({'test' => true})
[1,2,3,4,5].inject(0, :+)  # Ruby 2.3.8 —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π
```

**Level 3**: –ü–æ–ª–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ gems —Å–æ–±—Ä–∞–ª–∏—Å—å)
```ruby
require_relative 'prometheus_exporter'
app = PrometheusExporterApp.new
```

### 5. –°–º–µ–Ω–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
```yaml
# –ë—ã–ª–æ: –∫–∞–∂–¥—ã–π push/PR (–º–æ–≥–ª–æ –≤–∏—Å–Ω—É—Ç—å)
schedule:
  - cron: '0 6 * * 0'  # –°—Ç–∞–ª–æ: —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é
```

## üõ†Ô∏è –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### 1. –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
./check-legacy-status.sh
```
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è CI.

### 2. –£–ª—É—á—à–µ–Ω–Ω—ã–π Gemfile.legacy
```ruby
# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
ruby '2.3.8'
gem 'sinatra', '~> 2.0.8'
gem 'rack', '~> 2.0.9'  
gem 'json', '~> 2.3.1'

group :optional do
  gem 'nokogiri', '~> 1.10.10'  # –ú–æ–∂–µ—Ç –Ω–µ —Å–æ–±—Ä–∞—Ç—å—Å—è
end
```

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `LEGACY_RUBY_TESTING.md` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∏ —Ä–µ—à–µ–Ω–∏–π
- –¢—Ä–æ—É–±–ª—à—É—Ç–∏–Ω–≥ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- **–ù–∏–∫–∞–∫–∏—Ö –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –∑–∞–≤–∏—Å–∞–Ω–∏–π** - –º–∞–∫—Å–∏–º—É–º 15 –º–∏–Ω—É—Ç
- **–í—Å–µ–≥–¥–∞ –µ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç** - –¥–∞–∂–µ –µ—Å–ª–∏ —á–∞—Å—Ç—å —Ç–µ—Å—Ç–æ–≤ –Ω–µ –ø—Ä–æ—à–ª–∞
- **–ù–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Ä–∞–±–æ—Ç—É** (`continue-on-error: true`)
- **–ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ CI** (—Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é –≤–º–µ—Å—Ç–æ –∫–∞–∂–¥–æ–≥–æ commit)

### üìù –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏:
```
‚úÖ Ruby version compatible for legacy testing
‚úÖ Application syntax valid  
‚úÖ Core functionality working
‚ö†Ô∏è  Gem installation issues (may not be available or compatible)
‚ö†Ô∏è  Full application test skipped (gem issues)

üéØ Legacy Ruby 2.3.8 Test Summary:
   - This workflow tests basic compatibility with very old Ruby
   - Gem installation may fail due to compilation issues 
   - Basic Ruby syntax and methods are the primary test target
   - For production use, please use Ruby 3.2+ with Docker

‚úÖ Legacy compatibility test completed (results may vary)
```

### üìù –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º:
```
‚úÖ Ruby version compatible for legacy testing
‚úÖ Application syntax valid
‚úÖ Core functionality working 
‚úÖ Gems appear available for installation
‚úÖ Full application loads with Ruby 2.3.8

‚úÖ Legacy compatibility test completed
```

## üèÜ –ò—Ç–æ–≥

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|------------|----------------|------------------|
| **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** | ‚àû (–≤–∏—Å–ª–∏) | ‚â§ 15 –º–∏–Ω—É—Ç |
| **–ù–∞–ª–∏—á–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞** | ‚ùå –ù–∏–∫–æ–≥–¥–∞ | ‚úÖ –í—Å–µ–≥–¥–∞ |
| **–í–ª–∏—è–Ω–∏–µ –Ω–∞ CI** | ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ | ‚úÖ –ù–µ –±–ª–æ–∫–∏—Ä—É—é—Ç |
| **–ß–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø—É—Å–∫–∞** | ‚ùå –ö–∞–∂–¥—ã–π commit | ‚úÖ –†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é |
| **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ | ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–∞—è |
| **–õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** | ‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–∞ | ‚úÖ `./check-legacy-status.sh` |

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

### ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Ruby 3.2+** –∏–ª–∏ **Docker**
- Legacy —Ç–µ—Å—Ç—ã - —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã

### üîç –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
# –ü–µ—Ä–µ–¥ –ø—É—à–µ–º –≤ CI:
./check-legacy-status.sh

# –û—Ç–ª–∞–¥–∫–∞ —á–µ—Ä–µ–∑ Docker:
docker run -it --rm ruby:2.3.8 bash
```

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã legacy —Å–∏—Å—Ç–µ–º:
- –ù–µ –ø–æ–ª–∞–≥–∞–π—Ç–µ—Å—å –Ω–∞ Ruby 2.3.8 –≤ production
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

‚ú® **–ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–≤–∏—Å–∞—é—â–∏—Ö legacy —Ç–µ—Å—Ç–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!**
