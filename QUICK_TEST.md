# –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JRuby + Passenger

## üöÄ –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –¢–µ—Å—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π –≤–µ—Ä—Å–∏–∏ (–æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ, 2 –º–∏–Ω—É—Ç—ã) 
./test-fixed-dockerfile.sh test
```

## üõ†Ô∏è –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±

```bash
# –¢–µ—Å—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (–±—ã—Å—Ç—Ä–æ, 3 –º–∏–Ω—É—Ç—ã)
./test-fixed-dockerfile.sh minimal
```

## üõ´ –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±

```bash
# –¢–µ—Å—Ç —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (–±—ã—Å—Ç—Ä–æ, 5 –º–∏–Ω—É—Ç)
./test-fixed-dockerfile.sh simple
```

**–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏):**
```bash
# 1. –¢–µ—Å—Ç–æ–≤–∞—è –≤–µ—Ä—Å–∏—è (—Å–∞–º–∞—è –Ω–∞–¥–µ–∂–Ω–∞—è)
docker build -f src/Dockerfile.jruby-test -t monitus-jruby-test src/
docker run -p 8080:80 monitus-jruby-test

# 2. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
docker build -f src/Dockerfile.jruby-minimal -t monitus-jruby-minimal src/
docker run -p 8080:80 monitus-jruby-minimal

# 3. –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
docker build -f src/Dockerfile.jruby-passenger-simple -t monitus-jruby-passenger-simple src/
docker run -p 8080:80 monitus-jruby-passenger-simple

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
curl http://localhost:8080/health
curl http://localhost:8080/test      # –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ JRuby
curl http://localhost:8080/monitus/metrics
```

## üîß –ü–æ–ª–Ω—ã–π —Å–ø–æ—Å–æ–± (–¥–ª—è —ç–∫—Å–ø–µ—Ä—Ç–æ–≤)

```bash
# –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–π –∫–∞—Å—Ç–æ–º–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (–¥–æ–ª–≥–æ, 15+ –º–∏–Ω—É—Ç)
./test-fixed-dockerfile.sh
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç –∑–∞ 30-60 —Å–µ–∫—É–Ω–¥
- `/health` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `healthy`
- `/monitus/metrics` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Prometheus –º–µ—Ç—Ä–∏–∫–∏
- JRuby —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø–æ–ª–Ω—ã–º threading

### ‚ùå –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **¬´user app does not exist¬ª** ‚Üí –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
2. **GPG/network –æ—à–∏–±–∫–∏** ‚Üí –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç—É—é –≤–µ—Ä—Å–∏—é
3. **502 Bad Gateway** ‚Üí –ü–æ–¥–æ–∂–¥–∏—Ç–µ 60+ —Å–µ–∫—É–Ω–¥ –¥–ª—è –ø—Ä–æ–≥—Ä–µ–≤–∞ JRuby

## üèÉ‚Äç‚ôÇÔ∏è –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç

```bash
# –û–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
./test-fixed-dockerfile.sh
```

–ï—Å–ª–∏ –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è, —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø—Ä–æ–±—É–µ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—É—é.

---

**üí° –°–æ–≤–µ—Ç**: –ù–∞—á–Ω–∏—Ç–µ —Å `./test-fixed-dockerfile.sh test` - —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 100% —Å–ª—É—á–∞–µ–≤.

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π 4-—É—Ä–æ–≤–Ω–µ–≤—ã–π fallback:
```
./test-fixed-dockerfile.sh
   ‚Üì (–µ—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
–ü—Ä–æ–±—É–µ—Ç simple –≤–µ—Ä—Å–∏—é
   ‚Üì (–µ—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
–ü—Ä–æ–±—É–µ—Ç minimal –≤–µ—Ä—Å–∏—é
   ‚Üì (–µ—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
–ü—Ä–æ–±—É–µ—Ç test –≤–µ—Ä—Å–∏—é (–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)
```
